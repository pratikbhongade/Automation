import pyautogui
import time
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

# Setup WebDriver for the first browser
driver = webdriver.Edge()

# Step 1: Ask for the validation portal link
portal_link = input("Please enter the validation portal link: ")

# Step 2: Go to the submitted link
driver.get(portal_link)

# Step 3: Click on 'Set Testing Results' button
try:
    # Wait until the 'Set Testing Results' button is clickable
    set_results_button = WebDriverWait(driver, 10).until(
        EC.element_to_be_clickable((By.XPATH, "//button[@onclick='SetTestingResults()']"))
    )
    set_results_button.click()
except Exception as e:
    print(f"Error clicking 'Set Testing Results' button: {e}")

# Step 4: Use pyautogui to wait for the new browser to open
time.sleep(5)  # Adjust as needed for the new browser to open

# Step 5: Use pyautogui to click on 'Success' radio button
# Adjust coordinates as per your screen resolution
pyautogui.click(x=500, y=500)  # Coordinates of the 'Success' radio button

# Step 6: Use pyautogui to click 'OK' button
pyautogui.click(x=700, y=700)  # Coordinates of the 'OK' button

# Close the first browser
driver.quit()
