import pyautogui
import time
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

# Setup WebDriver for the first browser (Edge in this case)
driver = webdriver.Edge()

# Step 1: Ask for the validation portal link
portal_link = input("Please enter the validation portal link: ")

# Step 2: Go to the submitted link
driver.get(portal_link)

# Step 3: Click on 'Set Testing Results' button
try:
    # Wait until the 'Set Testing Results' button is clickable
    set_results_button = WebDriverWait(driver, 10).until(
        EC.element_to_be_clickable((By.XPATH, "//button[@onclick='SetTestingResults()']"))
    )
    set_results_button.click()
except Exception as e:
    print(f"Error clicking 'Set Testing Results' button: {e}")

# Step 4: Use pyautogui to handle the new browser window
time.sleep(5)  # Wait for the new browser to fully load

# Step 5: Click the 'Success' radio button using its coordinates
pyautogui.click(x=543, y=360)

# Step 6: Click the 'OK' button using its coordinates
pyautogui.click(x=1398, y=865)

# Step 7: Click the 'Confirmation' button using its coordinates
time.sleep(2)  # Adjust timing if necessary
pyautogui.click(x=1068, y=618)

# Close the first browser window
driver.quit()
