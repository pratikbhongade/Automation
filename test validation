import time
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import subprocess

# Initialize the first browser instance for the validation portal
driver1 = webdriver.Edge()

# Step 1: Navigate to the validation portal link
validation_portal = input("Please enter the validation portal link: ")
driver1.get(validation_portal)

# Step 2: Click on the 'Set Testing Results' button
set_testing_results_button = WebDriverWait(driver1, 20).until(
    EC.element_to_be_clickable((By.XPATH, "//button[contains(text(), 'Set Testing Results')]"))
)
set_testing_results_button.click()

# Pause to wait for the new window to open (in a new browser instance)
time.sleep(5)  # Adjust based on how long it takes for the new window to open

# Step 3: Open the new browser instance (assuming the URL is known or accessible)
# You can retrieve the URL from some application log or get it programmatically if possible
new_window_url = "https://example.com/new-window-url"  # Replace with the actual URL

# Step 4: Automate the new window in a new browser instance
driver2 = webdriver.Edge()
driver2.get(new_window_url)

# Step 5: Wait for the 'Success' radio button in the new window
success_radio = WebDriverWait(driver2, 20).until(
    EC.visibility_of_element_located((By.XPATH, "//input[@type='radio' and @value='Success']"))
)
success_radio.click()

# Step 6: Click the OK button
ok_button = WebDriverWait(driver2, 20).until(
    EC.element_to_be_clickable((By.XPATH, "//button[contains(text(), 'K')]"))
)
ok_button.click()

# Close the second window after completion
driver2.quit()

# Close the first browser instance
driver1.quit()
