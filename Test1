import time
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.common.exceptions import TimeoutException, NoSuchElementException

# Initialize Edge WebDriver
driver = webdriver.Edge()  # This will use the Edge WebDriver in your PATH

# Function to check if a tab opens properly
def check_tab(tab_element, tab_name, content_locator):
    try:
        time.sleep(5)  # Wait for 5 seconds before clicking the tab
        tab_element.click()
        WebDriverWait(driver, 10).until(
            EC.visibility_of_element_located(content_locator)
        )
        print(f"Tab '{tab_name}' opened successfully.")
        return True
    except TimeoutException:
        print(f"Failed to open tab '{tab_name}'.")
        return False

# Navigate to the webpage containing the tabs
driver.get('https://your-website-url.com')  # Replace with your actual URL

# Example tab elements and their corresponding content locators
tabs = {
    "Users": ("/fpa/Usr", (By.CSS_SELECTOR, "table.ListView")),
    "User Roles": ("/fpa/UsrRoles", (By.CSS_SELECTOR, "table.ListView")),
    "Accounts": ("/fpa/Acct", (By.CSS_SELECTOR, "table.ListView")),
    "GL/CC's": ("/fpa/GlCstCntr", (By.CSS_SELECTOR, "table.ListView")),
    "Printers": ("/fpa/Printer", (By.CSS_SELECTOR, "table.ListView")),
}

all_tabs_opened = True

for tab_name, (tab_href, content_locator) in tabs.items():
    try:
        # Find the tab element using its href attribute
        tab_element = WebDriverWait(driver, 10).until(
            EC.element_to_be_clickable((By.XPATH, f"//a[@href='{tab_href}']"))
        )
        success = check_tab(tab_element, tab_name, content_locator)
        if not success:
            all_tabs_opened = False
    except (TimeoutException, NoSuchElementException) as e:
        print(f"Tab '{tab_name}' not found or not clickable. Exception: {e}")
        all_tabs_opened = False

# Wait for 3 seconds before closing the browser
time.sleep(3)
# Close the browser
driver.quit()

# Print completion message if all tabs opened successfully
if all_tabs_opened:
    print("Validation completed.")
else:
    print("Validation failed.")
